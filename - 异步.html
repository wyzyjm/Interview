<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Run</title>
</head>

<body>
    <script>
        // Promise.resolve().then(() => {
        //     return new Error('error!!!')
        // }).then(res => {
        //     console.log("then: ", res)
        // }).catch(err => {
        //     console.log("catch: ", err)
        // })

        // const promise = Promise.resolve().then(() => {
        //     return promise;
        // })
        // promise.catch(console.err)

        // Promise.resolve(1)
        //     .then(2)
        //     .then(res => {
        //         Promise.resolve(2)
        //     })
        //     .then(console.log)


        // Promise.reject('err!!!')
        //     .then((res) => {
        //         console.log('success', res)
        //     }, (err) => {
        //         console.log('error', err)
        //     }).catch(err => {
        //         console.log('catch', err)
        //     })

        // Promise.resolve('1')
        //     .then(res => {
        //         console.log(res)
        //     })
        //     .finally(() => {
        //         console.log('finally')
        //     })
        // Promise.resolve('2')
        //     .finally(() => {
        //         console.log('finally2')
        //         return '我是finally2返回的值'
        //     })
        //     .then(res => {
        //         console.log('finally2后面的then函数', res)
        //     })

        // Promise.resolve('1')
        //     .finally(() => {
        //         console.log('finally1')
        //         throw new Error('我是finally中抛出的异常')
        //     })
        //     .then(res => {
        //         console.log('finally后面的then函数', res)
        //     })
        //     .catch(err => {
        //         console.log('捕获错误', err)
        //     })

        // function runAsync(x) {
        //     const p = new Promise(r => setTimeout(() => r(x, console.log(x)), 1000))
        //     return p
        // }
        // Promise.all([runAsync(1), runAsync(2), runAsync(3)]).then(res => console.log(res)) // 1s之后输出 1 2 3 [1,2,3]

        // function runAsync(x) {
        //     const p = new Promise(r => setTimeout(() => r(x, console.log(x)), 1000))
        //     return p
        // }
        // function runReject(x) {
        //     const p = new Promise((res, rej) => setTimeout(() => rej(`Error: ${x}`, console.log(x)), 1000 * x))
        //     return p
        // }
        // Promise.all([runAsync(1), runReject(4), runAsync(3), runReject(2)])
        //     .then(res => console.log('成功', res))
        //     .catch(err => console.log('失败', err))


        // async function async1() {
        //     console.log("async1 start");
        //     await async2();
        //     console.log("async1 end");
        // }
        // async function async2() {
        //     console.log("async2");
        // }
        // async1();
        // console.log('start')

        // async function async1() {
        //     console.log("async1 start");
        //     await async2();
        //     console.log("async1 end");
        //     setTimeout(() => {
        //         console.log('timer1')
        //     }, 0)
        // }
        // async function async2() {
        //     setTimeout(() => {
        //         console.log('timer2')
        //     }, 0)
        //     console.log("async2");
        // }
        // async1();
        // setTimeout(() => {
        //     console.log('timer3')
        // }, 0)
        // console.log("start")

        // async function async1() {
        //     console.log('async1 start');
        //     await new Promise(resolve => {
        //         console.log('promise1') // 没有返回值, 一直是pendding状态
        //     })
        //     console.log('async1 success');
        //     return 'async1 end'
        // }
        // console.log('srcipt start')
        // async1().then(res => console.log(res))
        // console.log('srcipt end')

        // async function async1() {
        //     console.log('async1 start');
        //     const res = await new Promise(resolve => {
        //         console.log('promise1')
        //         resolve('promise1 resolve')
        //     }).then(res => console.log('b', res))
        //     console.log('async1 success');
        //     return 'async1 end'
        // }
        // console.log('srcipt start')
        // async1().then(res => console.log('a', res))
        // console.log('srcipt end')

        // async function async1() {
        //     console.log("async1 start");
        //     await async2();
        //     console.log("async1 end");
        // }
        // async function async2() {
        //     console.log("async2");
        // }
        // console.log("script start");
        // setTimeout(function () {
        //     console.log("setTimeout");
        // }, 0);
        // async1();
        // new Promise(resolve => {
        //     console.log("promise1");
        //     resolve();
        // }).then(function () {
        //     console.log("promise2");
        // });
        // console.log('script end')


        // async function async1() {
        //     await async2();
        //     console.log('async1');
        //     return 'async1 success'
        // }
        // async function async2() {
        //     return new Promise((resolve, reject) => {
        //         console.log('async2')
        //         reject('error')
        //     })
        // }
        // async1().then(res => console.log(res))


        // const first = () => (new Promise((resolve, reject) => {
        //     console.log(3);
        //     let p = new Promise((resolve, reject) => {
        //         console.log(7);
        //         setTimeout(() => {
        //             console.log(5);
        //             resolve(6);
        //             console.log(p)
        //         }, 0)
        //         resolve(1);
        //     });
        //     resolve(2);
        //     p.then((arg) => {
        //         console.log(arg);
        //     });
        // }));
        // first().then((arg) => {
        //     console.log(arg);
        // });
        // console.log(4);

        // const async1 = async () => {
        //     console.log('async1');
        //     setTimeout(() => {
        //         console.log('timer1', new Date())
        //     }, 2000)

        //     // pendding
        //     await new Promise(resolve => {
        //         console.log('promise1')
        //     })
        //     console.log('async1 end')
        //     return 'async1 success'
        // }
        // console.log('script start');
        // async1().then(res => console.log(res));
        // console.log('script end');
        // Promise.resolve(1)
        //     .then(2)
        //     .then(Promise.resolve(3))
        //     .catch(4)
        //     .then(res => console.log(res, new Date()))
        // setTimeout(() => {
        //     console.log('timer2', new Date())
        // }, 1000)

        // const p1 = new Promise((resolve) => {
        //     setTimeout(() => {
        //         resolve('resolve3');
        //         console.log('timer1')
        //     }, 0)
        //     resolve('resovle1');
        //     resolve('resolve2');
        // }).then(res => {
        //     console.log(res)  // resolve1
        //     setTimeout(() => {
        //         console.log(p1)
        //     }, 1000)
        // }).finally(res => {
        //     console.log('finally', res)
        // })


        // console.log('1');

        // setTimeout(function () {
        //     console.log('2');
        //     process.nextTick(function () {
        //         console.log('3');
        //     })
        //     new Promise(function (resolve) {
        //         console.log('4');
        //         resolve();
        //     }).then(function () {
        //         console.log('5')
        //     })
        // })
        // process.nextTick(function () {
        //     console.log('6');
        // })
        // new Promise(function (resolve) {
        //     console.log('7');
        //     resolve();
        // }).then(function () {
        //     console.log('8')
        // })

        // setTimeout(function () {
        //     console.log('9');
        //     process.nextTick(function () {
        //         console.log('10');
        //     })
        //     new Promise(function (resolve) {
        //         console.log('11');
        //         resolve();
        //     }).then(function () {
        //         console.log('12')
        //     })
        // })

        // console.log(1)

        // setTimeout(() => {
        //     console.log(2)
        // })

        // new Promise(resolve => {
        //     console.log(3)
        //     resolve(4)
        // }).then(d => console.log(d))

        // setTimeout(() => {
        //     console.log(5)
        //     new Promise(resolve => {
        //         resolve(6)
        //     }).then(d => console.log(d))
        // })

        // setTimeout(() => {
        //     console.log(7)
        // })

        // console.log(8)

        /***************************************/
        // console.log(1);

        // setTimeout(() => {
        //     console.log(2);
        //     Promise.resolve().then(() => {
        //         console.log(3)
        //     });
        // });

        // new Promise((resolve, reject) => {
        //     console.log(4)
        //     resolve(5)
        // }).then((data) => {
        //     console.log(data);
        // })

        // setTimeout(() => {
        //     console.log(6);
        // })

        // console.log(7);
        /***************************************/
        // Promise.resolve().then(() => {
        //     console.log('1');
        //     throw 'Error';
        // }).then(() => {
        //     console.log('2');
        // }).catch(() => {
        //     console.log('3');
        //     throw 'Error';
        // }).then(() => {
        //     console.log('4');
        // }).catch(() => {
        //     console.log('5');
        // }).then(() => {
        //     console.log('6');
        // });

        /***************************************/
        // setTimeout(function () {
        //     console.log(1);
        // }, 100);

        // new Promise(function (resolve) {
        //     console.log(2);
        //     resolve();
        //     console.log(3);
        // }).then(function () {
        //     console.log(4);
        //     new Promise((resove, reject) => {
        //         console.log(5);
        //         setTimeout(() => {
        //             console.log(6);
        //         }, 10);
        //     })
        // });
        // console.log(7);
        // console.log(8);

        /***************************************/

        /***************************************/


        /*
            输出: 
                 
            微任务: 
               
            宏任务: 
                setTimeout 100
                setTimeout 10
         */
    </script>
</body>

</html>